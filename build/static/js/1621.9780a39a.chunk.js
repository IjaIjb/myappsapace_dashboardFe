"use strict";(self.webpackChunkmyappspacedashboard=self.webpackChunkmyappspacedashboard||[]).push([[1621],{8821:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var a=s(9379),o=s(5043),n=s(3216),r=s(3003),d=s(4630),l=s(4435),i=s(5200),c=s(5394),u=s(7488),m=(s(2342),s(8256),s(8985)),p=s(579);const x=()=>{const{id:e}=(0,n.g)(),t=(0,n.Zp)(),s=(0,r.d4)((e=>{var t;return(null===(t=e.globalState)||void 0===t?void 0:t.selectedStore)||null})),[x,b]=(0,o.useState)({code:"",discount_value:"",discount_type:"percentage",expiry_date:"",is_active:!0}),[g,f]=(0,o.useState)(!0),[h,y]=(0,o.useState)(!1),[v,j]=(0,o.useState)(!1),[N,_]=(0,o.useState)(""),[C,w]=(0,o.useState)(""),[S,k]=(0,o.useState)(!1),E=e=>{try{return new Date(e).toISOString().split("T")[0]}catch(t){return""}},D=new Date;D.setDate(D.getDate()+1);const F=D.toISOString().split("T")[0];(0,o.useEffect)((()=>{s&&e&&(f(!0),_(""),l.F.getSingleCoupon(s,e).then((e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.coupon){const t=e.data.coupon;b({code:t.code||"",discount_value:t.discount_value||"",discount_type:t.discount_type||"percentage",expiry_date:E(t.expiry_date)||"",is_active:1===t.is_active})}else _("Could not find coupon details.")})).catch((e=>{console.error("Error fetching coupon:",e),_("Failed to load coupon details. Please try again.")})).finally((()=>{f(!1)})))}),[s,e]);const A=e=>{const{name:t,value:s,type:o,checked:n}=e.target;b((0,a.A)((0,a.A)({},x),{},{[t]:"checkbox"===o?n:s}))},R=()=>{k(!1)};return g?(0,p.jsx)(d.A,{children:(0,p.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,p.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})})}):(0,p.jsxs)(d.A,{children:[(0,p.jsx)(m.a,{open:S,onClose:R,center:!0,classNames:{modal:"rounded-lg p-6 max-w-md w-full"},children:(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 mb-4",children:(0,p.jsx)(i.IXo,{className:"h-8 w-8 text-red-600"})}),(0,p.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-2",children:"Delete Coupon"}),(0,p.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"Are you sure you want to delete this coupon? This action cannot be undone."}),(0,p.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,p.jsx)("button",{type:"button",onClick:R,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),(0,p.jsx)("button",{type:"button",onClick:async()=>{if(!s)return _("No store selected. Please select a store first."),void R();j(!0),_("");try{const o=await l.F.deleteCoupon(s,e);var a;if(o.data)u.oR.success((null===o||void 0===o||null===(a=o.data)||void 0===a?void 0:a.message)||"Coupon deleted successfully!"),w("Coupon deleted successfully!"),R(),setTimeout((()=>{t("/dashboard/coupon")}),1500)}catch(r){var o,n;console.error("Error deleting coupon:",r),u.oR.error((null===(o=r.response)||void 0===o||null===(n=o.data)||void 0===n?void 0:n.message)||"Failed to delete coupon. Please try again."),R()}finally{j(!1)}},disabled:v,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:v?"Deleting...":"Delete"})]})]})}),(0,p.jsxs)("div",{className:" mx-auto p-4 bg-white rounded-lg shadow-md",children:[(0,p.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("button",{onClick:()=>t("/dashboard/coupons"),className:"mr-3 text-gray-600 hover:text-gray-900",children:(0,p.jsx)(c.NEn,{size:20})}),(0,p.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Edit Coupon"})]}),(0,p.jsxs)("button",{onClick:()=>{k(!0)},className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50",children:[(0,p.jsx)(i.IXo,{className:"mr-2"}),"Delete Coupon"]})]}),N&&(0,p.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:N}),C&&(0,p.jsx)("div",{className:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:C}),(0,p.jsxs)("form",{onSubmit:async o=>{if(o.preventDefault(),(()=>{if(_(""),!/^[A-Z0-9]+$/.test(x.code))return _("Coupon code must contain only uppercase letters and numbers (e.g., SURECODER14)"),!1;const e=parseFloat(x.discount_value);return isNaN(e)||e<=0?(_("Discount value must be greater than 0"),!1):"percentage"===x.discount_type&&(e<1||e>100)?(_("Percentage discount must be between 1 and 100"),!1):!!x.expiry_date||(_("Expiry date is required"),!1)})())if(s){y(!0),_(""),w("");try{const o=(0,a.A)((0,a.A)({},x),{},{discount_value:parseFloat(x.discount_value),is_active:x.is_active?1:0}),r=await l.F.updateCoupon(s,e,o);var n;if(r.data)w("Coupon updated successfully!"),u.oR.success((null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.message)||"Coupon updated successfully!"),setTimeout((()=>{t("/dashboard/coupons")}),1500)}catch(m){var r,d,i,c;console.error("Error updating coupon:",m),_((null===(r=m.response)||void 0===r||null===(d=r.data)||void 0===d?void 0:d.message)||"Failed to update coupon. Please try again."),u.oR.error((null===(i=m.response)||void 0===i||null===(c=i.data)||void 0===c?void 0:c.message)||"Failed to update coupon. Please try again.")}finally{y(!1)}}else _("No store selected. Please select a store first.")},children:[(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("label",{htmlFor:"code",className:"block text-gray-700 font-medium mb-2",children:"Coupon Code*"}),(0,p.jsx)("input",{type:"text",id:"code",name:"code",value:x.code,onChange:A,placeholder:"e.g., SURECODER14, FLASH30",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),(0,p.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Use uppercase letters and numbers only (e.g., SURECODER14)"})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("label",{htmlFor:"discount_value",className:"block text-gray-700 font-medium mb-2",children:"Discount Value*"}),(0,p.jsx)("input",{type:"number",id:"discount_value",name:"discount_value",value:x.discount_value,onChange:A,placeholder:"Enter discount value",min:"0.01",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),(0,p.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"percentage"===x.discount_type?"Enter a percentage value between 1-100%":"Enter a fixed amount"})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("label",{htmlFor:"discount_type",className:"block text-gray-700 font-medium mb-2",children:"Discount Type*"}),(0,p.jsxs)("select",{id:"discount_type",name:"discount_type",value:x.discount_type,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,p.jsx)("option",{value:"percentage",children:"Percentage (%)"}),(0,p.jsx)("option",{value:"fixed",children:"Fixed Amount"})]})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("label",{htmlFor:"expiry_date",className:"block text-gray-700 font-medium mb-2",children:"Expiry Date*"}),(0,p.jsx)("input",{type:"date",id:"expiry_date",name:"expiry_date",value:x.expiry_date,onChange:A,min:F,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,p.jsxs)("div",{className:"mb-6",children:[(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("input",{type:"checkbox",id:"is_active",name:"is_active",checked:x.is_active,onChange:A,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,p.jsx)("label",{htmlFor:"is_active",className:"ml-2 block text-gray-700",children:"Active Coupon"})]}),(0,p.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Inactive coupons cannot be used until activated"})]}),(0,p.jsx)("div",{className:"flex justify-end",children:(0,p.jsxs)("button",{type:"submit",disabled:h,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:[(0,p.jsx)(i.Bc_,{className:"mr-2"}),h?"Saving...":"Save Changes"]})})]})]})]})}}}]);
//# sourceMappingURL=1621.9780a39a.chunk.js.map