{"version":3,"file":"static/js/1717.0d83a5d9.chunk.js","mappings":"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","sources":["pages/dashboard/coupon/CreateCoupon.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '../../../store/store';\r\nimport { UserApis } from '../../../apis/userApi/userApi';\r\nimport DashboardLayout from '../../../components/DashboardLayout';\r\n\r\nimport { ToastContainer, toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst CreateCoupon = () => {\r\n  const selectedStore = useSelector(\r\n    (state: RootState) => state.globalState?.selectedStore || null\r\n  );\r\n  const navigate = useNavigate();\r\n\r\n  const [formData, setFormData] = useState({\r\n    code: '',\r\n    discount_value: '',\r\n    discount_type: 'percentage', // Default to percentage\r\n    expiry_date: '',\r\n    is_active: true, // Default to active\r\n  });\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n\r\n  // Get tomorrow's date in YYYY-MM-DD format for min date in date picker\r\n  const tomorrow = new Date();\r\n  tomorrow.setDate(tomorrow.getDate() + 1);\r\n  const tomorrowFormatted = tomorrow.toISOString().split('T')[0];\r\n\r\n  const handleChange = (e:any) => {\r\n    const { name, value, type, checked } = e.target;\r\n    setFormData({\r\n      ...formData,\r\n      [name]: type === 'checkbox' ? checked : value,\r\n    });\r\n  };\r\n\r\n  const validateForm = () => {\r\n    // Reset error message\r\n    setError('');\r\n\r\n    // Code validation (alphanumeric)\r\n    if (!/^[A-Z0-9]+$/.test(formData.code)) {\r\n      setError('Coupon code must contain only uppercase letters and numbers (e.g., SURECODER14)');\r\n      return false;\r\n    }\r\n\r\n    // Discount value validation (must be greater than 0)\r\n    const discountValue = parseFloat(formData.discount_value);\r\n    if (isNaN(discountValue) || discountValue <= 0) {\r\n      setError('Discount value must be greater than 0');\r\n      return false;\r\n    }\r\n\r\n    // For percentage, ensure value is between 1 and 100\r\n    if (formData.discount_type === 'percentage' && (discountValue < 1 || discountValue > 100)) {\r\n      setError('Percentage discount must be between 1 and 100');\r\n      return false;\r\n    }\r\n\r\n    // Expiry date validation\r\n    if (!formData.expiry_date) {\r\n      setError('Expiry date is required');\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const handleSubmit = async (e:any) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n\r\n    if (!selectedStore) {\r\n      setError('No store selected. Please select a store first.');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError('');\r\n    setSuccess('');\r\n\r\n    try {\r\n      // Prepare payload\r\n      const payload = {\r\n        ...formData,\r\n        discount_value: parseFloat(formData.discount_value),\r\n        is_active: formData.is_active ? 1 : 0,\r\n      };\r\n\r\n      // Call API\r\n      const response = await UserApis.createCoupon(selectedStore, payload);\r\n      console.log(response)\r\n      if (response.data) {\r\n        // Reset form\r\n        setFormData({\r\n          code: '',\r\n          discount_value: '',\r\n          discount_type: 'percentage',\r\n          expiry_date: '',\r\n          is_active: true,\r\n        });\r\n              toast.success(\r\n                  response?.data?.message || \"Coupon created successfully!\"\r\n                );\r\n                navigate(\"/dashboard/coupon\");\r\n      }\r\n    } catch (err:any) {\r\n      console.error('Error creating coupon:', err);\r\n      toast.error(err.response?.data?.message || 'Failed to create coupon. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <DashboardLayout>\r\n    <div className=\" mx-auto p-4 bg-white rounded-lg shadow-md\">\r\n      <h2 className=\"text-2xl font-semibold text-gray-800 mb-6\">Create New Coupon</h2>\r\n      \r\n      {error && (\r\n        <div className=\"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded\">\r\n          {error}\r\n        </div>\r\n      )}\r\n      \r\n      {success && (\r\n        <div className=\"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded\">\r\n          {success}\r\n        </div>\r\n      )}\r\n      \r\n      <form onSubmit={handleSubmit}>\r\n        <div className=\"mb-4\">\r\n          <label htmlFor=\"code\" className=\"block text-gray-700 font-medium mb-2\">\r\n            Coupon Code*\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"code\"\r\n            name=\"code\"\r\n            value={formData.code}\r\n            onChange={handleChange}\r\n            placeholder=\"e.g., SURECODER14, FLASH30\"\r\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            required\r\n          />\r\n          <p className=\"text-sm text-gray-500 mt-1\">\r\n            Use uppercase letters and numbers only (e.g., SURECODER14)\r\n          </p>\r\n        </div>\r\n        \r\n        <div className=\"mb-4\">\r\n          <label htmlFor=\"discount_value\" className=\"block text-gray-700 font-medium mb-2\">\r\n            Discount Value*\r\n          </label>\r\n          <input\r\n            type=\"number\"\r\n            id=\"discount_value\"\r\n            name=\"discount_value\"\r\n            value={formData.discount_value}\r\n            onChange={handleChange}\r\n            placeholder=\"Enter discount value\"\r\n            min=\"0.01\"\r\n            step=\"0.01\"\r\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            required\r\n          />\r\n          <p className=\"text-sm text-gray-500 mt-1\">\r\n            {formData.discount_type === 'percentage' \r\n              ? 'Enter a percentage value between 1-100%' \r\n              : 'Enter a fixed amount'}\r\n          </p>\r\n        </div>\r\n        \r\n        <div className=\"mb-4\">\r\n          <label htmlFor=\"discount_type\" className=\"block text-gray-700 font-medium mb-2\">\r\n            Discount Type*\r\n          </label>\r\n          <select\r\n            id=\"discount_type\"\r\n            name=\"discount_type\"\r\n            value={formData.discount_type}\r\n            onChange={handleChange}\r\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            required\r\n          >\r\n            <option value=\"percentage\">Percentage (%)</option>\r\n            <option value=\"fixed\">Fixed Amount</option>\r\n          </select>\r\n        </div>\r\n        \r\n        <div className=\"mb-4\">\r\n          <label htmlFor=\"expiry_date\" className=\"block text-gray-700 font-medium mb-2\">\r\n            Expiry Date*\r\n          </label>\r\n          <input\r\n            type=\"date\"\r\n            id=\"expiry_date\"\r\n            name=\"expiry_date\"\r\n            value={formData.expiry_date}\r\n            onChange={handleChange}\r\n            min={tomorrowFormatted}\r\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            required\r\n          />\r\n        </div>\r\n        \r\n        <div className=\"mb-6\">\r\n          <div className=\"flex items-center\">\r\n            <input\r\n              type=\"checkbox\"\r\n              id=\"is_active\"\r\n              name=\"is_active\"\r\n              checked={formData.is_active}\r\n              onChange={handleChange}\r\n              className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n            />\r\n            <label htmlFor=\"is_active\" className=\"ml-2 block text-gray-700\">\r\n              Active Coupon\r\n            </label>\r\n          </div>\r\n          <p className=\"text-sm text-gray-500 mt-1\">\r\n            Inactive coupons cannot be used until activated\r\n          </p>\r\n        </div>\r\n        \r\n        <div className=\"flex justify-end\">\r\n          <button\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            className={`px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${\r\n              loading ? 'opacity-50 cursor-not-allowed' : ''\r\n            }`}\r\n          >\r\n            {loading ? 'Creating...' : 'Create Coupon'}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n           <ToastContainer\r\n                  position=\"top-right\"\r\n                  autoClose={2000}\r\n                  hideProgressBar={true}\r\n                  newestOnTop={false}\r\n                  closeOnClick\r\n                  rtl={false}\r\n                  pauseOnFocusLoss\r\n                  draggable\r\n                  pauseOnHover\r\n                />\r\n    </DashboardLayout>\r\n  );\r\n};\r\n\r\nexport default CreateCoupon;"],"names":["CreateCoupon","selectedStore","useSelector","state","_state$globalState","globalState","navigate","useNavigate","formData","setFormData","useState","code","discount_value","discount_type","expiry_date","is_active","loading","setLoading","error","setError","success","setSuccess","tomorrow","Date","setDate","getDate","tomorrowFormatted","toISOString","split","handleChange","e","name","value","type","checked","target","_objectSpread","_jsxs","DashboardLayout","children","className","_jsx","onSubmit","async","preventDefault","validateForm","test","discountValue","parseFloat","isNaN","payload","response","UserApis","createCoupon","_response$data","console","log","data","toast","message","err","_err$response","_err$response$data","htmlFor","id","onChange","placeholder","required","min","step","disabled","concat","ToastContainer","position","autoClose","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover"],"sourceRoot":""}